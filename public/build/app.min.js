/*! zoo 2014-12-28 */
angular.module("ZooApp",["ngAnimate","ngResource","ngRoute","ngSanitize","mgcrea.ngStrap","angular-growl","cgBusy","ui.select","angular-loading-bar","oitozero.ngSweetAlert","ZooAppResources"]).config(["$routeProvider","$locationProvider","uiSelectConfig","$asideProvider",function(a,b,c,d){b.html5Mode(!0),a.when("/",{title:"Главная",templateUrl:"/src/templates/overview.html",controller:"OverviewCtrl"}).when("/animals/:id",{title:"Животное",templateUrl:"/src/templates/animal.html",controller:"AnimalCtrl",resolve:{animal:["Animals","$route",function(a,b){return a.get({id:parseInt(b.current.params.id)})}]}}).otherwise({redirectTo:"/"}),c.theme="bootstrap",angular.extend(d.defaults,{animation:"am-fade-and-slide-left",placement:"left",container:"body",keyboard:!1,backdrop:"static"})}]).value("cgBusyDefaults",{message:"Загрузка"}).run(["$rootScope",function(a){a.$on("$routeChangeSuccess",function(b,c){a.title=c.$$route.title})}]),angular.module("ZooApp").controller("AnimalCtrl",["$scope","$routeParams","$filter","animal","Animals","AnimalsEats","Eats","ConfirmService",function(a,b,c,d,e,f,g,h){a.animal=d,a.animal.eat={},a.animal.eat.editing={},a.animal.eat.edit=function(){},a.eats=g.query().$promise.then(function(b){a.eats=b,a.eatsObject=c("list2object")(b)}),a.eatAddSubmit=function(c){var d=new f;d.animal_id=parseInt(b.id),d.eat_id=c.eat,d.eat_volume=c.volume,d.$save(function(b){a.animal.eats.push(b)})},a.removeEat=function(b,c){h.remove(function(d){d&&(a.animal.eats[b].deleting=!0,f.remove({id:c},function(){a.animal.eats.splice(b,1)}))})}}]),angular.module("ZooApp").controller("OverviewCtrl",["$scope","Animals","Eats",function(a,b,c){a.animals=b.query(),a.eats=c.query()}]),angular.module("ZooApp").directive("go",["$location",function(a){return{strict:"A",scope:{link:"=go"},link:function(b,c){c.css({cursor:"pointer"}),c.on("click",function(){a.url(b.link),b.$apply()})}}}]).directive("back",["$window","$location",function(a,b){return{restrict:"A",scope:{link:"@back"},link:function(c,d){d.bind("click",function(){!a.history.length&&c.link?b.url(c.link):(a.history.back(),c.$apply())})}}}]).directive("onEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.onEnter)}),b.preventDefault())})}}).directive("onEsc",function(){return function(a,b,c){b.bind("keydown keypress",function(b){27===b.which&&(a.$apply(function(){a.$eval(c.onEnter)}),b.preventDefault())})}}).directive("canChange",[function(){return{restrict:"A",replace:!0,transclude:!0,templateUrl:"/src/templates/modules/directives/can-change.html",controller:["$scope",function(){}]}}]),angular.module("ZooApp").filter("units",[function(){var a={1:"шт",2:"мл",3:"гр"};return function(b){if("undefined"==typeof b||null===b)return b;if(void 0===a[b])throw"Unit not found in list units!";return a[b]}}]).filter("list2object",[function(){return function(a,b){if(!a||!angular.isArray(a))return a;("undefined"==typeof b||null===b)&&(b="id");var c={};return angular.forEach(a,function(a){c[a[b]]=a}),c}}]),angular.module("ZooAppResources",["ngResource"]).factory("Animals",["$resource",function(a){return a("/api/animals/:id")}]).factory("AnimalsEats",["$resource",function(a){return a("/api/animals/eats/:id")}]).factory("Eats",["$resource",function(a){return a("/api/eats/:id")}]),angular.module("ZooApp").service("ConfirmService",["SweetAlert",function(a){return{remove:function(b){a.swal({title:"Вы уверены что хотите удалить?",type:"warning",showCancelButton:!0,cancelButtonText:"Отмена",confirmButtonColor:"#DD6B55",confirmButtonText:"Да, уверен"},function(a){b&&b(a)})}}}]);